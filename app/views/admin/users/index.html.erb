<%- model_class = User -%>
<div class="page-header">
  <h1><%= model_class.model_name.human %></h1>
</div>

<table class="table table-striped table-bordered table-hover">
  <thead>
  <tr>
    <th><%= model_class.human_attribute_name(:name) %></th>
    <th><%= model_class.human_attribute_name(:mobile) %></th>
    <th><%=t '.actions', :default => t("helpers.actions") %></th>
  </tr>
  </thead>
  <tbody>
  <% @users.each do |user| %>
      <tr>
        <% if user.id == @current_user.id %>
        <% if policy(user).show? %>
        <td><%= link_to user.name,'',"data-href"=> admin_user_path(user) %></td>
            <% else	  %>
            <td><%= user.name %></td>
         <% end %>
        <td><%= user.mobile %></td>
        <td>
          <div class="hidden-sm hidden-xs action-buttons">
            <% if policy(user).show? %>
                <a class="btn btn-xs btn-info" data-href="<%= edit_admin_user_path(user) %>">
                  <i class="ace-icon fa fa-pencil bigger-130"></i>
                </a>
            <% end %>
            <% if policy(user).isAdmin? %>
                <%= link_to raw("<i class='ace-icon fa fa-trash-o bigger-130'></i>"),
                            '',
                            "data-href"=>admin_user_path(user),
                            :method => :delete,
                            :data => { :confirm => '你确定删除该用户吗?'},
                            :class => 'btn btn-xs btn-danger' %>
            <% end %>
          </div>
          </td>
        <% elsif @current_user.step.nil? %>
            <td><%= link_to user.name,'',"data-href"=> admin_user_path(user) %></td>

        <td><%= user.mobile %></td>
        <td>
          <div class="hidden-sm hidden-xs action-buttons">
                <a class="btn btn-xs btn-info" href="<%= edit_admin_user_path(user) %>">
                  <i class="ace-icon fa fa-pencil bigger-130"></i>
                </a>
                <%= link_to raw("<i class='ace-icon fa fa-trash-o bigger-130'></i>"),
                            '',
                            "data-href"=>admin_user_path(user),
                            :method => :delete,
                            :data => { :confirm => '你确定删除该用户吗?'},
                            :class => 'btn btn-xs btn-danger' %>
          </div>
        </td>
        <% end %>

      </tr>
  <% end %>
  </tbody>
</table>

<div class="row">
  <div class="col-xs-6">
    <div class="dataTables_info" id="dynamic-table_info" role="status" aria-live="polite">
      </div>
  </div>
  <div class="col-xs-6">
    <div class="dataTables_paginate paging_simple_numbers" id="dynamic-table_paginate">
      <ul class="pagination">
        <li class="paginate_button previous disabled" aria-controls="dynamic-table" tabindex="0" id="dynamic-table_previous">
          <%= paginate @users %>
        </li>
      </ul>
    </div>
  </div>
</div>

 <% if @current_user.step.nil?  %>
          <%= link_to t('.new', :default => t("helpers.links.new")),
                      new_admin_user_path,
                      :class => 'btn btn-primary' %>
 <% end %>


